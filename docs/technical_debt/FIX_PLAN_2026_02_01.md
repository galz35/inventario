# Plan de Correcci√≥n de Errores Cr√≠ticos (Build Backend) - 2026-02-01

El sistema presenta fallos de compilaci√≥n masivos en el Backend debido a inconsistencias en el nombrado de archivos (Casing), referencias rotas a DTOs y m√©todos faltantes en repositorios. Esto impide que el servidor inicie, causando `ERR_CONNECTION_REFUSED` en el Frontend.

Estdo Actual: **CRITICAL BLOCKER**

## üìã Diagn√≥stico de Errores

### 1. Inconsistencia de May√∫sculas/Min√∫sculas (Case Sensitivity)
TypeScript en Windows a veces es permisivo, pero el build estricto o Linux fallan. Hay referencias cruzadas incorrectas:
- **Error:** `File name '.../src/inventariocore/InventarioCore.controller.ts' differs from already included file name '.../inventariocore.controller.ts'`
- **Causa:** Imports inconsistentes. Algunos importan desde `./InventarioCore.repo` y otros desde `./inventariocore.repo`.
- **Archivos Afectados:**
    - `src/inventariocore/inventariocore.module.ts`
    - `src/inventariocore/tasks.service.ts`
    - `src/planning/planning.service.ts`
    - `src/scripts/debug_carnet.ts`
    - `src/scripts/verify_soft_delete.ts`

### 2. M√≥dulos/DTOs No Encontrados
- **Error:** `Cannot find module './dto/InventarioCore.dtos'`
- **Causa:** Probablemente el archivo se renombr√≥, se movi√≥ o no se est√° exportando correctamente el index.
- **Archivos Afectados:**
    - `src/inventariocore/inventariocore.controller.ts`
    - `src/inventariocore/tasks.service.ts`

### 3. M√©todos Faltantes en `admin.repo`
- **Error:** `Property 'obtenerPerfilesSeguridad' does not exist on type...`
- **Causa:** El servicio `admin.service` intenta llamar m√©todos que no est√°n exportados o definidos en `admin.repo.ts`.
- **M√©todos Faltantes:**
    - `obtenerPerfilesSeguridad`
    - `obtenerOrganigrama`
    - `crearNodoOrganigrama`
    - `asignarUsuarioNodo`

---

## üõ†Ô∏è Plan de Acci√≥n (Checklist)

### Fase 1: Normalizaci√≥n de Imports (Casing)
- [x] Renombrar f√≠sicamente archivos si es necesario para asegurar convenci√≥n `kebab-case` o `camelCase` consistente. Est√°ndar sugerido: `nombre.tipo.ts` (todo min√∫sculas).
- [x] Corregir imports en `src/inventariocore/inventariocore.module.ts`: Cambiar `./InventarioCore.controller` a `./inventariocore.controller`.
- [x] Corregir imports en `src/inventariocore/tasks.service.ts`: Cambiar `./InventarioCore.repo` a `./inventariocore.repo` (o el nombre real del archivo).
- [x] Corregir imports en scripts (`debug_carnet.ts`, etc.) para apuntar a la ruta correcta en min√∫sculas.

### Fase 2: Recuperaci√≥n de DTOs
- [x] Verificar la ubicaci√≥n real de `InventarioCore.dtos.ts` (Renombrado a `core.dtos.ts`).
- [x] Corregir rutas de importaci√≥n en `inventariocore.controller.ts` y `tasks.service.ts`.

### Fase 3: Implementaci√≥n de M√©todos en AdminRepo
- [x] Abrir `src/admin/admin.repo.ts`.
- [x] Implementar (o hacer p√∫blicos) los m√©todos:
    - [x] `obtenerPerfilesSeguridad()`
    - [x] `obtenerOrganigrama()`
    - [x] `crearNodoOrganigrama(dto)`
    - [x] `asignarUsuarioNodo(idUsuario, idNodo, rol)`

### Fase 4: Verificaci√≥n
- [x] Ejecutar `npm run build` en backend para validar 0 errores.
- [x] Reiniciar servidor backend.
- [ ] Verificar carga del Dashboard y Cat√°logos en Frontend.

---

> Este documento sirve como gu√≠a de ejecuci√≥n para el agente. Proceder√© inmediatamente con la Fase 1.
